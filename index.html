<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conferência de Notas</title>
    <!-- Dependências Locais -->
    <link href="libs/bootstrap.min.css" rel="stylesheet">
    <link href="libs/bootstrap-icons.css" rel="stylesheet">
    <script src="libs/xlsx.full.min.js"></script>

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="alert-container" style="position: fixed; top: 10px; right: 10px; z-index: 1050;"></div>

    <div class="app-container">
        <div class="panel-superior">
            <div class="container-fluid">
                <h3 class="mt-2">App de Conferência de Notas</h3>

                <details class="container-setup border rounded p-3 my-3" open>
                    <summary class="fw-bold">Configurações e Carregamento</summary>
                    
                    <div class="row align-items-center mt-3">
                        <div class="col-auto">
                            <label class="form-label fw-bold">Modo de Operação:</label>
                        </div>
                        <div class="col-auto">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="mode-online" name="operating-mode" value="online">
                                <label class="form-check-label" for="mode-online">Online</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" id="mode-offline" name="operating-mode" value="offline" checked>
                                <label class="form-check-label" for="mode-offline">Offline</label>
                            </div>
                        </div>
                    </div>

                    <!-- Online Mode Options -->
                    <div id="online-options" class="mt-3 p-3 border rounded bg-light" style="display: none;">
                        <p class="text-muted small">A base de produtos será carregada da URL pública.</p>
                        <div class="mb-3">
                            <label for="notes-file" class="form-label">Carregar Arquivo de Notas (.xlsx):</label>
                            <input type="file" id="notes-file" class="form-control form-control-sm" accept=".xlsx">
                        </div>
                    </div>

                    <!-- Offline Mode Options -->
                    <div id="offline-options" class="mt-3 p-3 border rounded bg-light">
                        <p class="text-muted small">Os dados serão carregados de <code>/data/produtos.csv</code> e <code>/data/notas.xlsx</code>.</p>
                        <button id="load-offline-data-btn" class="btn btn-primary btn-sm">Carregar Dados Locais</button>
                    </div>
                </details>

                <hr>

                <div class="container-conference">
                    <h2>Conferência</h2>
                    <div id="note-details-display" class="alert alert-info" style="display: none;">
                        <span id="note-info-combined"></span>
                    </div>

                    <div class="row g-2 align-items-end">
                        <div class="col-md-4">
                            <label for="search-note-input" class="form-label">Buscar Nota Fiscal:</label>
                            <input type="text" id="search-note-input" class="form-control form-control-sm" placeholder="Digite o número ou nome..." disabled>
                        </div>
                        <div class="col-md-5">
                            <label for="notes-select" class="form-label">Selecione a Nota Fiscal:</label>
                            <select id="notes-select" class="form-select form-select-sm" disabled>
                                <option>Aguardando dados...</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                             <button id="finalize-note-btn" class="btn btn-success w-100" style="display: none;">Finalizar Nota</button>
                        </div>
                    </div>
                     <div class="mt-3">
                        <label for="barcode-input" class="form-label">Leitura do Código:</label>
                        <input type="text" id="barcode-input" class="form-control" placeholder="Leia o código de barras aqui..." disabled>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel-inferior">
            <table id="items-table" class="table table-striped table-hover table-sm">
                <thead class="table-dark">
                    <tr>
                        <th>Código</th>
                        <th>Referência</th>
                        <th>EAN13</th>
                        <th>Produto</th>
                        <th>Qtd. na Nota</th>
                        <th>Qtd. Conferida</th>
                        <th>Status</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Linhas da tabela serão inseridas aqui pelo JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>